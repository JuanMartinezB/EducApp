<app-navbar></app-navbar>

<div class="p-8 max-w-7xl mx-auto">
  <h1 class="text-3xl font-bold mb-2 text-gray-800">Historial Académico</h1>
  <p class="mb-6 text-xl text-blue-600">Estudiante: **{{ studentName }}**</p>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="p-6 bg-blue-50 rounded-xl shadow-lg">
      <p class="text-xl font-semibold text-blue-700">Promedio General Ponderado:</p>
      <p class="text-4xl font-extrabold text-blue-600">{{ calcularPromedio() }}</p>
    </div>
  </div>

  <div class="p-6 bg-white rounded-xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-gray-800">Detalle de Calificaciones</h2>
    
    <div *ngIf="historial.length === 0" class="text-gray-500 p-4 border rounded-lg bg-gray-50">No hay asignaturas registradas en el historial.</div>

    <div class="overflow-x-auto" *ngIf="historial.length > 0">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Asignatura</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Créditos</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nota</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Semestre</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let item of historial">
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.asignatura.nombre }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.asignatura.creditos }}</td>
            <td 
              class="px-6 py-4 whitespace-nowrap text-sm font-bold" 
              [ngClass]="{'text-green-600': item.nota >= 3.0, 'text-red-600': item.nota < 3.0}">
              {{ item.nota.toFixed(1) }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.semestre }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              <span 
                [ngClass]="{'bg-green-100 text-green-800': item.nota >= 3.0, 'bg-red-100 text-red-800': item.nota < 3.0}"
                class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                {{ item.nota >= 3.0 ? 'Aprobado' : 'Reprobado' }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>